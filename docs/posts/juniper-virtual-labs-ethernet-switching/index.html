<!DOCTYPE html>
<html lang="en">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <title>
  Juniper Virtual Labs - Ethernet-switching · Leegacy System
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="Lee Dowdells">
<meta name="description" content="I wanted to write up a quick post on getting a virtual lab up and running for studying towards the JNCIS-ENT exam. I was lucky enough to go on the in-person juniper training course for JEX &amp; JIR so I have physical lab examples that I wanted to run at home. To do this I choose to use Eve-NG as it seems to be gaining popularity and covers a reasonable amount of supported images.">
<meta name="keywords" content="blog, devops, neteng, juniper">
<meta name="fediverse:creator" content="" />


  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Juniper Virtual Labs - Ethernet-switching">
  <meta name="twitter:description" content="I wanted to write up a quick post on getting a virtual lab up and running for studying towards the JNCIS-ENT exam. I was lucky enough to go on the in-person juniper training course for JEX &amp; JIR so I have physical lab examples that I wanted to run at home. To do this I choose to use Eve-NG as it seems to be gaining popularity and covers a reasonable amount of supported images.">

<meta property="og:url" content="https://www.leegacysystem.dev/posts/juniper-virtual-labs-ethernet-switching/">
  <meta property="og:site_name" content="Leegacy System">
  <meta property="og:title" content="Juniper Virtual Labs - Ethernet-switching">
  <meta property="og:description" content="I wanted to write up a quick post on getting a virtual lab up and running for studying towards the JNCIS-ENT exam. I was lucky enough to go on the in-person juniper training course for JEX &amp; JIR so I have physical lab examples that I wanted to run at home. To do this I choose to use Eve-NG as it seems to be gaining popularity and covers a reasonable amount of supported images.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2018-08-19T13:42:23+00:00">
    <meta property="article:modified_time" content="2018-08-19T13:42:23+00:00">
    <meta property="article:tag" content="Juniper">
    <meta property="article:tag" content="Home-Lab">
    <meta property="article:tag" content="VQFX">
    <meta property="article:tag" content="JNCIS-ENT">
    <meta property="article:tag" content="Eve-NG">




<link rel="canonical" href="https://www.leegacysystem.dev/posts/juniper-virtual-labs-ethernet-switching/">


<link rel="preload" href="/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.css" media="screen">






  
    
    
    <link rel="stylesheet" href="/css/coder-dark.css" media="screen">
  



 




<link rel="icon" type="image/svg+xml" href="/images/site/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="/images/site/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/images/site/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">









</head>






<body class="preload-transitions colorscheme-dark">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="https://www.leegacysystem.dev/">
      Leegacy System
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="/posts/">Blog</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="https://www.leegacysystem.dev/posts/juniper-virtual-labs-ethernet-switching/">
              Juniper Virtual Labs - Ethernet-switching
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa-solid fa-calendar" aria-hidden="true"></i>
              <time datetime="2018-08-19T13:42:23Z">
                August 19, 2018
              </time>
            </span>
            <span class="reading-time">
              <i class="fa-solid fa-clock" aria-hidden="true"></i>
              4-minute read
            </span>
          </div>
          
          <div class="categories">
  <i class="fa-solid fa-folder" aria-hidden="true"></i>
    <a href="/categories/juniper/">Juniper</a></div>

          <div class="tags">
  <i class="fa-solid fa-tag" aria-hidden="true"></i>
    <span class="tag">
      <a href="/tags/juniper/">Juniper</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="/tags/home-lab/">Home-Lab</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="/tags/vqfx/">VQFX</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="/tags/jncis-ent/">JNCIS-ENT</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="/tags/eve-ng/">Eve-NG</a>
    </span></div>

        </div>
      </header>

      <div class="post-content">
        
        <p>I wanted to write up a quick post on getting a virtual lab up and running for studying towards the JNCIS-ENT exam. I was lucky enough to go on the in-person juniper training course for JEX &amp; JIR so I have physical lab examples that I wanted to run at home. To do this I choose to use Eve-NG as it seems to be gaining popularity and covers a reasonable amount of <a href="http://www.eve-ng.net/documentation/supported-images"  class="external-link" target="_blank" rel="noopener">supported images</a>. I&rsquo;m not going to cover the installation/configuration of eve-ng as their documentation is very good. However, as a caution, the main downside to Eve vs GNS3 that I have found is simply there is less community discussion around Eve-ng.</p>
<h4 id="the-problem">
  <strong>The problem</strong>
  <a class="heading-link" href="#the-problem">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h4>
<p>In the JEX syllabus there is a section on Ethernet-switching. The very first lab covers this section and expects some switching functionality to work. I had originally configured two vSRXs to do this lab and got most of the way through. However as soon as I tried to run &ldquo;show ethernet-switching table&rdquo; I got no result.</p>
<div style="text-align:center;"><a href="/images/posts/2018/01/vsrx-output.png"><img src="/images/posts/2018/01/vsrx-output.png" width="520" ></a></div>
<br>
<p>After looking over the Juniper feature explorer I found that ethernet-switching is not available to the vSRX. I had seen discussions saying it was possible with the 17 code base, though the image I downloaded did not seem to work on Eve so I haven&rsquo;t tested this.</p>
<h4 id="the-solution">
  <strong>The solution</strong>
  <a class="heading-link" href="#the-solution">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h4>
<p>I ended up spending more time than I would care to admit on this, I resorted to using the vQFX evaluation image provided by juniper (specifically: 15.1X53-D60.4). The trick here is to use both the VRE and VPFE in conjunction by connecting the em1. I was caught out here as I had originally tried this but I had not waited long enough for the RE and PFE to sync.</p>
<div style="text-align:center;"><a href="/images/posts/2018/01/vqfx-topology.png"><img src="/images/posts/2018/01/vqfx-topology.png" width="520" ></a></div>
<br>
<p>If your RE and PFE are connected as shown above, all you have to do is power them up and wait. On my home server they both powered up fairly fast (compared to vsrx), however it took another 10/15 minutes before they both started to work as expected. On your first attempt if you power them up and go for a 30 minute coffee/youtube mini binge, by the time you come back &ldquo;show interface terse&rdquo; should include xe-0/0/X interfaces.</p>
<p>In order to test that basic switching was working as expected I created a test VLAN on both REs, put the connecting interface between REs (xe-0/0/2) into the vlan and created a L3 interface with an IP assigned at each end. I&rsquo;ve included both full configurations below along with my test output.</p>
<div style="text-align:center;"><a href="/images/posts/2018/01/vqfx-testing.png"><img src="/images/posts/2018/01/vqfx-testing.png" width="630" ></a></div>
<br>
<div style="text-align:center;"><a href="/images/posts/2018/01/vqfx-output.png"><img src="/images/posts/2018/01/vqfx-output.png" width="630" ></a></div>
<br>
<h5 id="_vqfx-re1-configuration_">
  <strong><em>vQFX-RE1 configuration</em></strong>
  <a class="heading-link" href="#_vqfx-re1-configuration_">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h5>
<pre tabindex="0"><code>root@vQFX-RE1# show configuration | display set | except &#34;dhcp&#34;
set version 15.1X53-D60.4
set system host-name vQFX-RE1
set system root-authentication encrypted-password &#34;$1$VarABIj2$69bMxK8kQ/hdkAbUdIiam/&#34;
set system root-authentication ssh-rsa &#34;ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEA6NF8iallvQVp22WDkTkyrtvp9eWW6A8YVr+kz4TjGYe7gHzIw+niNltGEFHzD8+v1I2YJ6oXevct1YeS0o9HZyN1Q9qgCgzUFtdOKLv6IedplqoPkcmF0aYet2PkEDo3MlTBckFXPITAMzF8dJSIFo9D8HfdOV0IAdx4O7PtixWKn5y2hMNG0zQPyUecp4pzC6kivAIhyfHilFR61RGL+GPXQ2MWZWFYbAGjyiYJnAmCP3NOTd0jMZEnDkbUvxhMmBYSdETk1rRgm+R4LOzFUGaHqHDLKLX+FIPKcF96hrucXzcWyLbIbEgE98OHlnVYCzRdK8jlqm8tehUc9c9WhQ== vagrant insecure public key&#34;
set system login user vagrant uid 2000
set system login user vagrant class super-user
set system login user vagrant authentication ssh-rsa &#34;ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEA6NF8iallvQVp22WDkTkyrtvp9eWW6A8YVr+kz4TjGYe7gHzIw+niNltGEFHzD8+v1I2YJ6oXevct1YeS0o9HZyN1Q9qgCgzUFtdOKLv6IedplqoPkcmF0aYet2PkEDo3MlTBckFXPITAMzF8dJSIFo9D8HfdOV0IAdx4O7PtixWKn5y2hMNG0zQPyUecp4pzC6kivAIhyfHilFR61RGL+GPXQ2MWZWFYbAGjyiYJnAmCP3NOTd0jMZEnDkbUvxhMmBYSdETk1rRgm+R4LOzFUGaHqHDLKLX+FIPKcF96hrucXzcWyLbIbEgE98OHlnVYCzRdK8jlqm8tehUc9c9WhQ== vagrant insecure public key&#34;
set system services ssh root-login allow
set system services netconf ssh
set system services rest http port 8080
set system services rest enable-explorer
set system syslog user * any emergency
set system syslog file messages any notice
set system syslog file messages authorization info
set system syslog file interactive-commands interactive-commands any
set system extensions providers juniper license-type juniper deployment-scope commercial
set system extensions providers chef license-type juniper deployment-scope commercial
set interfaces xe-0/0/2 unit 0 family ethernet-switching vlan members test
set interfaces em1 unit 0 family inet address 169.254.0.2/24
set interfaces irb unit 99 family inet address 192.168.7.1/30
set forwarding-options storm-control-profiles default all
set protocols igmp-snooping vlan default
set vlans default vlan-id 1
set vlans test vlan-id 99
set vlans test l3-interface irb.99
</code></pre><br>
<h5 id="_vqfx-re2-configuration_">
  <strong><em>vQFX-RE2 configuration</em></strong>
  <a class="heading-link" href="#_vqfx-re2-configuration_">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h5>
<pre tabindex="0"><code>root@vQFX-RE2# show configuration | display set | except &#34;dhcp&#34;

set version 15.1X53-D60.4
set system host-name vQFX-RE2 
set system root-authentication encrypted-password &#34;$1$VarABIj2$69bMxK8kQ/hdkAbUdIiam/&#34;
set system root-authentication ssh-rsa &#34;ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEA6NF8iallvQVp22WDkTkyrtvp9eWW6A8YVr+kz4TjGYe7gHzIw+niNltGEFHzD8+v1I2YJ6oXevct1YeS0o9HZyN1Q9qgCgzUFtdOKLv6IedplqoPkcmF0aYet2PkEDo3MlTBckFXPITAMzF8dJSIFo9D8HfdOV0IAdx4O7PtixWKn5y2hMNG0zQPyUecp4pzC6kivAIhyfHilFR61RGL+GPXQ2MWZWFYbAGjyiYJnAmCP3NOTd0jMZEnDkbUvxhMmBYSdETk1rRgm+R4LOzFUGaHqHDLKLX+FIPKcF96hrucXzcWyLbIbEgE98OHlnVYCzRdK8jlqm8tehUc9c9WhQ== vagrant insecure public key&#34;
set system login user vagrant uid 2000 
set system login user vagrant class super-user
set system login user vagrant authentication ssh-rsa &#34;ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEA6NF8iallvQVp22WDkTkyrtvp9eWW6A8YVr+kz4TjGYe7gHzIw+niNltGEFHzD8+v1I2YJ6oXevct1YeS0o9HZyN1Q9qgCgzUFtdOKLv6IedplqoPkcmF0aYet2PkEDo3MlTBckFXPITAMzF8dJSIFo9D8HfdOV0IAdx4O7PtixWKn5y2hMNG0zQPyUecp4pzC6kivAIhyfHilFR61RGL+GPXQ2MWZWFYbAGjyiYJnAmCP3NOTd0jMZEnDkbUvxhMmBYSdETk1rRgm+R4LOzFUGaHqHDLKLX+FIPKcF96hrucXzcWyLbIbEgE98OHlnVYCzRdK8jlqm8tehUc9c9WhQ== vagrant insecure public key&#34;
set system services ssh root-login allow
set system services netconf ssh
set system services rest http port 8080
set system services rest enable-explorer
set system syslog user * any emergency
set system syslog file messages any notice
set system syslog file messages authorization info
set system syslog file interactive-commands interactive-commands any
set system extensions providers juniper license-type juniper deployment-scope commercial
set system extensions providers chef license-type juniper deployment-scope commercial
set interfaces xe-0/0/2 unit 0 family ethernet-switching vlan members test
set interfaces em1 unit 0 family inet address 169.254.0.2/24
set interfaces irb unit 99 family inet address 192.168.7.2/30
set forwarding-options storm-control-profiles default all
set protocols igmp-snooping vlan default
set vlans default vlan-id 1
set vlans test vlan-id 99
set vlans test l3-interface irb.99
</code></pre>
      </div>


      <footer>
        


        
        
        
        
        

        
        
      </footer>
    </article>

    
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    All posts are my own ramblings... sorry study notes.
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.js"></script>
  

  

  


  
  



  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
</body>

</html>
