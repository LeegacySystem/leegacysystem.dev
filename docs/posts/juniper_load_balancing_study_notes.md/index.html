<!DOCTYPE html>
<html lang="en">

<head>
  <title>
  Juniper Load Balancing Study Notes · Leegacy System
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="Lee Dowdells">
<meta name="description" content="By default in Junos when two equal cost paths exist a hash algorithm is used to determing which route will become the active FIB route and which will be come inactive. However if the links are equal cost there is the negative effect of having an used link, load balancing allows for both links to be utilise at the same time.
A routing policy can be used to allow all equal cost paths to be load balanced or only specific equal cost paths.">
<meta name="keywords" content="blog, devops, neteng, juniper">
<meta name="fediverse:creator" content="" />


  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Juniper Load Balancing Study Notes">
  <meta name="twitter:description" content="By default in Junos when two equal cost paths exist a hash algorithm is used to determing which route will become the active FIB route and which will be come inactive. However if the links are equal cost there is the negative effect of having an used link, load balancing allows for both links to be utilise at the same time.
A routing policy can be used to allow all equal cost paths to be load balanced or only specific equal cost paths.">

<meta property="og:url" content="https://www.leegacysystem.dev/posts/juniper_load_balancing_study_notes.md/">
  <meta property="og:site_name" content="Leegacy System">
  <meta property="og:title" content="Juniper Load Balancing Study Notes">
  <meta property="og:description" content="By default in Junos when two equal cost paths exist a hash algorithm is used to determing which route will become the active FIB route and which will be come inactive. However if the links are equal cost there is the negative effect of having an used link, load balancing allows for both links to be utilise at the same time.
A routing policy can be used to allow all equal cost paths to be load balanced or only specific equal cost paths.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2019-03-21T18:55:00+00:00">
    <meta property="article:modified_time" content="2019-03-21T18:55:00+00:00">
    <meta property="article:tag" content="Juniper">
    <meta property="article:tag" content="Routing">
    <meta property="article:tag" content="JNCIS-ENT">




<link rel="canonical" href="https://www.leegacysystem.dev/posts/juniper_load_balancing_study_notes.md/">


<link rel="preload" href="/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.min.07092c1350ffd254998dc43a44ae96e617d14af4df4602626878df89189c5e1a.css" integrity="sha256-BwksE1D/0lSZjcQ6RK6W5hfRSvTfRgJiaHjfiRicXho=" crossorigin="anonymous" media="screen" />






  
    
    
    <link rel="stylesheet" href="/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css" integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin="anonymous" media="screen" />
  



 




<link rel="icon" type="image/svg+xml" href="/images/site/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="/images/site/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/images/site/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">









</head>






<body class="preload-transitions colorscheme-dark">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="https://www.leegacysystem.dev/">
      Leegacy System
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="/posts/">Blog</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="https://www.leegacysystem.dev/posts/juniper_load_balancing_study_notes.md/">
              Juniper Load Balancing Study Notes
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa-solid fa-calendar" aria-hidden="true"></i>
              <time datetime="2019-03-21T18:55:00Z">
                March 21, 2019
              </time>
            </span>
            <span class="reading-time">
              <i class="fa-solid fa-clock" aria-hidden="true"></i>
              2-minute read
            </span>
          </div>
          
          <div class="categories">
  <i class="fa-solid fa-folder" aria-hidden="true"></i>
    <a href="/categories/juniper/">Juniper</a></div>

          <div class="tags">
  <i class="fa-solid fa-tag" aria-hidden="true"></i>
    <span class="tag">
      <a href="/tags/juniper/">Juniper</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="/tags/routing/">Routing</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="/tags/jncis-ent/">JNCIS-ENT</a>
    </span></div>

        </div>
      </header>

      <div class="post-content">
        
        <p>By default in Junos when two equal cost paths exist a hash algorithm is used to determing which route will become the active FIB route and which will be come inactive. However if the links are equal cost there is the negative effect of having an used link, load balancing allows for both links to be utilise at the same time.</p>
<p>A routing policy can be used to allow all equal cost paths to be load balanced or only specific equal cost paths. A system wise prefix lenght also has to be defined in fowarding-options.</p>
<p>Network vendors typically implement load balancing as in a per-packet or per-flow approach. This is one area where Juniper is really rather confusing. Historically LB in Junos was per-packet and as such the configuration statement is per-packet. However presumably for backwards compatability the statement is still per-packet but in the background its actually doing per-flow. Per-flow is the modern standard approach as it reduces the chance the destination recieving out-of-order packets.</p>
<p>A flow is defined by default in Junos as the source and destination IP addresses, port inforamtion is ignored. Junos lets you modify this definition to include layer 4 port information in the hash. An important not is that every ICMP packet is trated as a new flow which may cause odd results and cause confusion when troubleshooting.</p>

      </div>


      <footer>
        


        
        
        
        
        

        
        
      </footer>
    </article>

    
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    All posts are my own ramblings... sorry study notes.
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js" integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script>
  

  

  


  
  



  

  

  

  
<script defer src='https://static.cloudflareinsights.com/beacon.min.js'
        data-cf-beacon='{"token": "a3e23d0e9f3541179b1ae8f47639e993"}'></script>



  

  

  

  

  

  

  

  

  

  

  
</body>

</html>
